(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"58c1":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"row items-center q-pb-md"},[a("div",[e._v("选择时间：")]),a("q-btn",{attrs:{icon:"event",label:e.model.from+" - "+e.model.to,outline:""}},[a("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{range:"",mask:"YYYY-MM-DD",options:e.optionsFn},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},[a("div",{staticClass:"row items-center justify-end q-gutter-sm"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"取 消",flat:""}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"确 定",color:"primary",flat:""},on:{click:e.getSummary}})],1)])],1)],1)],1),a("q-table",{attrs:{title:"统计总量",data:e.summaries.Total,columns:e.totalColumns,"row-key":"RefDate",loading:e.loading},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-btn",{attrs:{color:"primary","icon-right":"archive",label:"导出 csv","no-caps":""},on:{click:function(t){return e.exportTable("总量-"+e.model.from+"-"+e.model.to,e.summaries.Total,e.totalColumns)}}})]},proxy:!0}])}),e._l(e.summaries.AppSummaries,(function(t){return a("q-table",{key:t.Appid,attrs:{title:t.Nickname,data:t.Summaries,columns:e.totalColumns,"row-key":"RefDate"},scopedSlots:e._u([{key:"top-right",fn:function(){return[t.Err?a("span",{staticClass:"text-red text-subtitle1"},[e._v("\n        "+e._s(t.Err)+"\n      ")]):e._e(),a("q-btn",{attrs:{color:"primary","icon-right":"archive",label:"导出 csv","no-caps":""},on:{click:function(a){return e.exportTable(t.Nickname+"-"+e.model.from+"-"+e.model.to,t.Summaries,e.totalColumns)}}})]},proxy:!0}],null,!0)})}))],2)},r=[],n=a("a357"),s=a("bd4c");const i=Date.now(),l=s["b"].formatDate(i,"YYYY-MM-DD"),m=s["b"].formatDate(i,"YYYY/MM/DD"),c=864e5,p=s["b"].formatDate(i-c,"YYYY-MM-DD");function u(e,t){let a=void 0!==t?t(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`}var d={name:"UserSummary",data(){return{model:{appids:[],from:p,to:l},loading:!1,expanded:!1,totalColumns:[{name:"RefDate",align:"right",label:"日期",field:"RefDate"},{name:"NewUser",align:"right",label:"新增用户",field:"NewUser"},{name:"CancelUser",align:"right",label:"取关用户",field:"CancelUser"},{name:"PositiveUser",align:"right",label:"净增用户",field:e=>e.NewUser-e.CancelUser,format:e=>`${e}`},{name:"CumulateUser",align:"right",label:"用户总量",field:"CumulateUser"}],summaries:{Total:[],AppSummaries:[]},Summary:{RefDate:"",NewUser:0,CancelUser:0,CumulateUser:0},AppSummary:{Appid:"",Nickname:"",Err:"",Summaries:[]}}},created(){},methods:{getSummary(){const e={Appids:this.model.appids,BeginDate:this.model.from,EndDate:this.model.to};this.loading=!0,this.$axios.get("/user-summary",{params:e}).then((e=>{e=e.data,e&&e.Data?this.summaries=e.Data:e.Message&&this.$q.notify(e.Message),this.loading=!1}))},optionsFn(e){return e<=m},exportTable(e,t,a){const o=[a.map((e=>u(e.label)))].concat(t.map((e=>a.map((t=>u("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format))).join(",")))).join("\r\n"),r=Object(n["a"])(`${e}.csv`,o,"text/csv");!0!==r&&this.$q.notify({message:"浏览器阻止下载文件...",color:"negative",icon:"warning"})}}},f=d,b=a("2877"),g=a("9989"),h=a("9c40"),v=a("7cbe"),y=a("52ee"),D=a("eaac"),w=a("7f67"),C=a("eebe"),Y=a.n(C),k=Object(b["a"])(f,o,r,!1,null,"3199a85c",null);t["default"]=k.exports;Y()(k,"components",{QPage:g["a"],QBtn:h["a"],QPopupProxy:v["a"],QDate:y["a"],QTable:D["a"]}),Y()(k,"directives",{ClosePopup:w["a"]})}}]);