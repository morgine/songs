(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"58c1":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-page",{attrs:{padding:""}},[t("div",{staticClass:"row items-center q-pb-md"},[t("q-form",{staticClass:"q-gutter-lg"},[t("q-input",{attrs:{type:"textarea",filled:"",label:"指定的公众号APPID",hint:"不填则统计所有公众号，多个公众号以':'号分割"},model:{value:e.appids,callback:function(a){e.appids=a},expression:"appids"}}),t("q-input",{attrs:{filled:"",label:"开始日期"},scopedSlots:e._u([{key:"append",fn:function(){return[t("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[t("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t("q-date",{attrs:{mask:"YYYY-MM-DD"},model:{value:e.params.BeginDate,callback:function(a){e.$set(e.params,"BeginDate",a)},expression:"params.BeginDate"}},[t("div",{staticClass:"row items-center justify-end"},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.params.BeginDate,callback:function(a){e.$set(e.params,"BeginDate",a)},expression:"params.BeginDate"}}),t("q-input",{attrs:{filled:"",label:"结束日期"},scopedSlots:e._u([{key:"append",fn:function(){return[t("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[t("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t("q-date",{attrs:{mask:"YYYY-MM-DD"},model:{value:e.params.EndDate,callback:function(a){e.$set(e.params,"EndDate",a)},expression:"params.EndDate"}},[t("div",{staticClass:"row items-center justify-end"},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.params.EndDate,callback:function(a){e.$set(e.params,"EndDate",a)},expression:"params.EndDate"}}),t("div",[t("q-btn",{attrs:{label:"获取统计",type:"submit",color:"primary"},on:{click:e.getSummary}})],1)],1)],1),t("q-table",{attrs:{title:"统计总量",data:e.summaries.Total,columns:e.totalColumns,"row-key":"RefDate",loading:e.loading},scopedSlots:e._u([{key:"top-right",fn:function(){return[t("q-btn",{attrs:{color:"primary","icon-right":"archive",label:"导出 csv","no-caps":""},on:{click:function(a){return e.exportTable("总量-"+e.model.from+"-"+e.model.to,e.summaries.Total,e.totalColumns)}}})]},proxy:!0}])}),e._l(e.summaries.AppSummaries,(function(a){return t("q-table",{key:a.Appid,attrs:{title:a.Nickname,data:a.Summaries,columns:e.totalColumns,"row-key":"RefDate"},scopedSlots:e._u([{key:"top-right",fn:function(){return[a.Err?t("span",{staticClass:"text-red text-subtitle1"},[e._v("\n        "+e._s(a.Err)+"\n      ")]):e._e(),t("q-btn",{attrs:{color:"primary","icon-right":"archive",label:"导出 csv","no-caps":""},on:{click:function(t){return e.exportTable(a.Nickname+"-"+e.model.from+"-"+e.model.to,a.Summaries,e.totalColumns)}}})]},proxy:!0}],null,!0)})}))],2)},n=[],r=t("bd4c"),i=t("a357");const l=Date.now(),o=r["b"].formatDate(l,"YYYY-MM-DD"),p=864e5,c=r["b"].formatDate(l-p,"YYYY-MM-DD");function m(e,a){let t=void 0!==a?a(e):e;return t=void 0===t||null===t?"":String(t),t=t.split('"').join('""'),`"${t}"`}var u={name:"UserSummary",data(){return{params:{Appids:"",BeginDate:c,EndDate:o},loading:!1,expanded:!1,totalColumns:[{name:"ref_date",align:"right",label:"日期",field:"ref_date"},{name:"new_user",align:"right",label:"新增用户",field:"new_user"},{name:"cancel_user",align:"right",label:"取关用户",field:"cancel_user"},{name:"positive_user",align:"right",label:"净增用户",field:e=>e.new_user-e.cancel_user},{name:"cumulate_user",align:"right",label:"用户总量",field:"cumulate_user"}],summaries:{Total:[],AppSummaries:[]},Summary:{ref_date:"",new_user:0,cancel_user:0,cumulate_user:0},AppSummary:{Appid:"",Nickname:"",Err:"",Summaries:[]}}},methods:{getSummary(){this.loading=!0;const e={BeginDate:this.params.BeginDate,EndDate:this.params.EndDate};if(e.BeginDate>e.EndDate){const a=e.EndDate;e.EndDate=e.BeginDate,e.BeginDate=a}this.params.Appids&&(e.Appids=this.params.Appids.split(":")),this.$axios.get("/user-summary",{params:e}).then((e=>{e=e.data,e&&e.Data?this.summaries=e.Data:e.Message&&this.$q.notify(e.Message),this.loading=!1}))},exportTable(e,a,t){const s=[t.map((e=>m(e.label)))].concat(a.map((e=>t.map((a=>m("function"===typeof a.field?a.field(e):e[void 0===a.field?a.name:a.field],a.format))).join(",")))).join("\r\n"),n=Object(i["a"])(`${e}.csv`,s,"text/csv");!0!==n&&this.$q.notify({message:"浏览器阻止下载文件...",color:"negative",icon:"warning"})}}},d=u,f=t("2877"),g=t("9989"),b=t("0378"),D=t("27f9"),y=t("0016"),v=t("7cbe"),h=t("52ee"),_=t("9c40"),k=t("eaac"),q=t("7f67"),x=t("eebe"),w=t.n(x),E=Object(f["a"])(d,s,n,!1,null,"b4eda8ba",null);a["default"]=E.exports;w()(E,"components",{QPage:g["a"],QForm:b["a"],QInput:D["a"],QIcon:y["a"],QPopupProxy:v["a"],QDate:h["a"],QBtn:_["a"],QTable:k["a"]}),w()(E,"directives",{ClosePopup:q["a"]})}}]);