(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{7792:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("q-form",{staticClass:"row full-width",on:{submit:e.uploadImage}},[a("q-file",{staticClass:"col-8",attrs:{name:"picture",filled:"",multiple:"","use-chips":"",label:"选择上传文件",accept:".jpg, .png, image/*"},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),a("div",{staticClass:"col-3 row items-center q-ml-lg"},[a("q-btn",{attrs:{label:"提交上传",type:"submit",color:"primary",disable:!e.files}})],1)],1),a("q-table",{attrs:{title:"Treats",data:e.data,columns:e.columns,"row-key":"name",selection:"multiple",selected:e.selected,pagination:e.pagination,loading:e.loading,grid:"","hide-header":""},on:{"update:selected":function(t){e.selected=t},"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-btn",{attrs:{disable:!e.selected||0===e.selected.length},on:{click:e.delImages}},[e._v("删除")])]},proxy:!0},{key:"item",fn:function(t){return[a("div",{staticClass:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:t.selected?"transform: scale(0.95);":""},[a("q-card",{class:t.selected?"bg-grey-2":""},[a("q-card-section",[a("q-checkbox",{attrs:{dense:""},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"props.selected"}},[a("q-img",{attrs:{src:t.row.Url}})],1)],1),a("q-separator")],1)],1)]}}])})],1)},i=[],n=(a("a434"),a("ddb0"),{data(){return{selectedAll:!1,selected:[],files:null,pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:15,rowsNumber:10},loading:!1,columns:[{name:"ID",align:"center",label:"ID",field:"ID"},{name:"File",label:"File",field:"File"},{name:"Url",label:"Url",field:"Url"}],data:[]}},watch:{selectedAll(e){this.selected=e?this.data:[]}},created(){this.count()},methods:{count(){this.loading=!0,this.$axios.get("/big-picture/count").then((e=>{e=e.data,e&&e.Data&&(this.pagination.rowsNumber=e.Data,this.onRequest({pagination:this.pagination})),this.loading=!1}))},onRequest(e){const{page:t,rowsPerPage:a,sortBy:s,descending:i}=e.pagination;this.loading=!0;const n=(t-1)*a,l={Limit:a,Offset:n};s&&(l.Column=s,l.Desc=i),this.$axios.get("/big-pictures",{params:l}).then((e=>{e=e.data,e&&e.Data&&(this.data.splice(0,this.data.length,...e.Data),this.pagination.page=t,this.pagination.rowsPerPage=a,this.pagination.sortBy=s,this.pagination.descending=i,this.loading=!1)}))},uploadImage(e){const t=new FormData(e.target);this.loading=!0,this.$axios.put("/big-pictures",t).then((e=>{e=e.data,e&&e.Data&&this.count()}))},delImages(){const e=[];for(const t of this.selected)e.push(t.ID);this.loading=!0,this.$axios.delete("/big-pictures",{params:{IDs:e}}).then((t=>{t=t.data,(t&&t.Data||0===t.Data)&&(this.pagination.rowsNumber=t.Data);for(const a of e)for(let e=0;e<this.data.length;e++)this.data[e].ID===a&&this.data.splice(e,1);this.selected=[],this.loading=!1}))}}}),l=n,o=a("2877"),c=a("9989"),d=a("0378"),r=a("7d53"),g=a("9c40"),p=a("eaac"),u=a("8f8e"),h=a("f09f"),m=a("a370"),f=a("068f"),b=a("eb85"),w=a("eebe"),D=a.n(w),q=Object(o["a"])(l,s,i,!1,null,"19429853",null);t["default"]=q.exports;D()(q,"components",{QPage:c["a"],QForm:d["a"],QFile:r["a"],QBtn:g["a"],QTable:p["a"],QCheckbox:u["a"],QCard:h["a"],QCardSection:m["a"],QImg:f["a"],QSeparator:b["a"]})}}]);